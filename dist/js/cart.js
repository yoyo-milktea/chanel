"use strict";var uname=getCookie("uname"),upsd=getCookie("upsd");function setName(){uname&&upsd&&$(".loginbtn").html("欢迎您，"+uname+"！")}setName();var newnum=JSON.parse(localStorage.getItem("num"));$(".login > div > em").html(newnum),$("main > p >a").html(newnum);var str,goodsinfo=JSON.parse(localStorage.getItem("goodsinfo")),num=0,addlist=JSON.parse(localStorage.getItem("addlist")),newaddlist=addlist.reduce(function(t,n){return n in t?t[n]++:t[n]=1,t},{});for(key in newaddlist){var shopLists=goodsinfo.filter(function(t,n){return t.productid===key});0!==shopLists.length&&shopLists.forEach(function(t){str+='\n            <li data-id="'.concat(t.productid,'">\n            <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>\n            <div class="image">\n                <img src="').concat(t.productimages[0][209],'" alt="">\n            </div>\n            <div class="info">\n                <p>').concat(t.productname,"</p>\n                <p>").concat(t.productdescription,"</p>\n                <p>\n                    <em>").concat(t.productimages[0].shadename,"&nbsp;</em>-<em>&nbsp;¥<i>").concat(t.productprice.toFixed(2),'</i></em>\n                </p>\n            </div>\n            <div class="num">\n                <span class="reduce">-</span>\n                <input class="count" type="text" value="').concat(newaddlist[key],'">\n                <span class="add">+</span>\n            </div>\n            <div class="sum">\n                ¥ <span>').concat(1*t.productprice.toFixed(2)*(1*newaddlist[key]),"</span>\n            </div>\n        </li>")})}$(".goodsinfo").html(str);var allSum=0;$(".goodsinfo > li").each(function(t,n){allSum+=1*$(this).children().eq(4).children().html()}),$("#allnum").html(allSum),$("ul").on("click",".reduce",function(){var t=1*$(this).next().val(),n=1*$(this).parent().prev().children().last().children().last().children().last().html(),e=($(this).parent().next().children().last().html(),1*$(this).parent().parent().parent().next().children().eq(2).children().last().children().last().html()),a=$(this).parent().parent().data("id");if(0<t){var i=t-1;$(this).next().val(i);var l=(i*n).toFixed(2);$(this).parent().next().children().last().html(l);var s=(e-n).toFixed(2);$("#allnum").html(s),newnum-=1,$(".login > div > em").html(newnum),$("main > p >a").html(newnum),localStorage.setItem("num",JSON.stringify(newnum)),addlist.splice($.inArray(a,addlist),1),localStorage.setItem("addlist",JSON.stringify(addlist))}}),$("ul").on("click",".add",function(){var t=1*$(this).prev().val(),n=1*$(this).parent().prev().children().last().children().last().children().last().html(),e=($(this).parent().next().children().last().html(),1*$(this).parent().parent().parent().next().children().eq(2).children().last().children().last().html()),a=$(this).parent().parent().data("id"),i=t+1;$(this).prev().val(i);var l=(i*n).toFixed(2);$(this).parent().next().children().last().html(l);var s=(e+n).toFixed(2);$("#allnum").html(s),newnum+=1,$(".login > div > em").html(newnum),$("main > p >a").html(newnum),localStorage.setItem("num",JSON.stringify(newnum)),addlist.push(a),localStorage.setItem("addlist",JSON.stringify(addlist))}),$("ul").on("click",".glyphicon",function(){var t=$(this).parent().data("id");$("#allnum").html(1*$("#allnum").html()-1*$(this).next().next().next().next().children().html());var n=1*JSON.parse(localStorage.getItem("num"))-$(this).next().next().next().children().eq(1).val();localStorage.setItem("num",JSON.stringify(n)),$(".login > div > em").html(n),$("main > p >a").html(n);var e=$(this).next().next().next().children().eq(1).val();addlist.splice($.inArray(t,addlist),e),localStorage.setItem("addlist",JSON.stringify(addlist)),$(this).parent().remove()});